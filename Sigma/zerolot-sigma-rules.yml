title: ZEROLOT Wiper Malware Detection
id: 7e9f4a2b-8c3d-4e5f-9a1b-2c3d4e5f6a7b
status: experimental
description: Detects ZEROLOT wiper malware activities associated with Sandworm APT group
author: litemars
date: 2025/08/28
references:
    - https://www.eset.com/us/about/newsroom/research/eset-research-apt-report-russian-cyberattacks-in-ukraine-intensify-sandworm-unleashes-new-destructive-wiper/
    - https://www.immersivelabs.com/resources/blog/zerolot-analysis-inside-sandworms-destructive-new-wiper
tags:
    - attack.impact
    - attack.t1485  # Data Destruction
    - attack.t1561.002  # Disk Structure Wipe
    - attack.t1106  # Native API
    - attack.defense_evasion
    - attack.t1497  # Virtualization/Sandbox Evasion
logsource:
    category: process_creation
    product: windows
detection:
    selection_fsutil_zero:
        Image|endswith: '\\fsutil.exe'
        CommandLine|contains:
            - 'setzerodataoffset'
            - 'file setzerodataoffset'
    
    selection_physical_drive_access:
        CommandLine|contains:
            - '\\\\.\\PhysicalDrive'
            - 'PhysicalDrive0'
            - 'PhysicalDrive1'
    
    selection_suspicious_process:
        ParentImage|endswith:
            - '\\taskhost.exe'
            - '\\svchost.exe'
            - '\\rundll32.exe'
        Image|endswith:
            - '\\fsutil.exe'
            - '\\diskpart.exe'
            - '\\wmic.exe'
    
    selection_registry_autoruns:
        Image|endswith: '\\reg.exe'
        CommandLine|contains:
            - 'HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run'
            - 'REG_SZ /d ""'
            - '/v StartupFolder /t REG_SZ /d'
    
    selection_wipe_indicators:
        CommandLine|contains:
            - 'cipher /w:'
            - 'sdelete -p'
            - 'format /fs:NTFS /p:'
            - 'diskpart /s'
    
    condition: 
        (selection_fsutil_zero and selection_physical_drive_access) or
        (selection_suspicious_process and selection_fsutil_zero) or
        (selection_registry_autoruns and selection_wipe_indicators) or
        (2 of selection_*)

falsepositives:
    - Legitimate system administration activities
    - Disk maintenance operations
    - System recovery procedures

level: critical

---

title: ZEROLOT File System Manipulation
id: 8f1a5b3c-9d4e-5f6a-7b8c-3d4e5f6a7b8c
status: experimental
description: Detects file system manipulation patterns consistent with ZEROLOT wiper malware
author: litemars
date: 2025/08/28
tags:
    - attack.impact
    - attack.t1485
    - attack.t1083  # File and Directory Discovery
logsource:
    category: file_event
    product: windows
detection:
    selection_file_enum:
        EventID: 11  # Sysmon File Create
        TargetFilename|contains:
            - 'C:\\Users\\'
            - 'C:\\Documents and Settings\\'
        ProcessName|endswith:
            - '.exe'
        ProcessName|contains:
            - 'temp'
            - 'tmp'
    
    selection_zero_files:
        EventID: 2  # Sysmon File Creation Time Changed
        ProcessName|endswith: '\\fsutil.exe'
    
    selection_mass_file_access:
        EventID: 1  # Sysmon Process Create
        CommandLine|contains:
            - 'for /r'
            - 'dir /s'
            - 'Get-ChildItem -Recurse'
        ParentProcessName|endswith:
            - '\\cmd.exe'
            - '\\powershell.exe'
    
    timeframe: 5m
    condition: 
        (selection_file_enum and selection_zero_files) or
        (selection_mass_file_access and count(*) > 100)

falsepositives:
    - File indexing services
    - Antivirus scans
    - Backup operations

level: high

---

title: ZEROLOT Network Communication Patterns
id: 9a2b6c4d-1e3f-7a8b-9c2d-4e5f6a7b8c9d
status: experimental
description: Detects network communication patterns associated with ZEROLOT C2
author: litemars
date: 2025/08/28
tags:
    - attack.command_and_control
    - attack.t1071.001  # Application Layer Protocol
logsource:
    category: network_connection
    product: windows
detection:
    selection_outbound:
        Initiated: 'true'
        Protocol: 'tcp'
        DestinationPort: 
            - 80
            - 443
            - 8080
            - 8443
    
    selection_process:
        ProcessName|endswith:
            - '\\rundll32.exe'
            - '\\regsvr32.exe'
            - '\\mshta.exe'
            - '\\powershell.exe'
    
    selection_suspicious_domains:
        DestinationHostname|contains:
            - '.tk'
            - '.ml'
            - '.ga'
            - '.cf'
            - 'tempuri.org'
            - 'pastebin.com'
    
    selection_user_agent:
        RequestHeader|contains:
            - 'Mozilla/4.0 (compatible; MSIE'
            - 'User-Agent: *'
            - 'curl/'
            - 'wget/'
    
    condition: 
        selection_outbound and 
        (selection_process or selection_suspicious_domains or selection_user_agent)

falsepositives:
    - Legitimate software updates
    - System telemetry
    - Browser activity

level: medium

---

title: ZEROLOT Process Injection and Evasion
id: 1b3c5d7e-2f4a-8b9c-1d3e-5f6a7b8c9d1e
status: experimental
description: Detects process injection and evasion techniques used by ZEROLOT malware
author: litemars
date: 2025/08/28
tags:
    - attack.defense_evasion
    - attack.t1055  # Process Injection
    - attack.t1497  # Virtualization/Sandbox Evasion
logsource:
    category: process_creation
    product: windows
detection:
    selection_injection:
        EventID: 8  # Sysmon CreateRemoteThread
        SourceProcessName|endswith:
            - '.exe'
        TargetProcessName|endswith:
            - '\\explorer.exe'
            - '\\winlogon.exe'
            - '\\csrss.exe'
    
    selection_hollow:
        EventID: 10  # Sysmon ProcessAccess
        GrantedAccess: 
            - '0x1F3FFF'
            - '0x1FFFFF'
            - '0x143A'
        ProcessName|endswith: '.exe'
        TargetProcessName|endswith:
            - '\\svchost.exe'
            - '\\rundll32.exe'
    
    selection_delay:
        EventID: 1  # Sysmon Process Create
        CommandLine|contains:
            - 'ping -n'
            - 'timeout /t'
            - 'Start-Sleep'
            - 'Thread.Sleep'
    
    selection_anti_analysis:
        ProcessName|endswith: '.exe'
        CommandLine|contains:
            - 'IsDebuggerPresent'
            - 'CheckRemoteDebuggerPresent'
            - 'GetTickCount'
            - 'rdtsc'
    
    condition: 
        selection_injection or
        selection_hollow or
        (selection_delay and selection_anti_analysis)

falsepositives:
    - Legitimate software with anti-debugging
    - System utilities
    - Software installers

level: high