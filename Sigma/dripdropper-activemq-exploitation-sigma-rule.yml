title: DripDropper Apache ActiveMQ Exploitation
id: 2c4d6e8f-3a5b-7c9d-2e4f-6a8b9c1d3e5f
status: experimental
description: Detects DripDropper malware exploitation of Apache ActiveMQ CVE-2023-46604
author: litemars
date: 2025/08/28
references:
    - https://thehackernews.com/2025/08/apache-activemq-flaw-exploited-to.html
    - https://www.secpod.com/blog/exploitation-in-progress-apache-activemq-vulnerability-used-to-deliver-dripdropper-malware/
tags:
    - attack.initial_access
    - attack.t1190  # Exploit Public-Facing Application
    - attack.persistence
    - attack.t1543.002  # Systemd Service
    - attack.defense_evasion
logsource:
    category: process_creation
    product: linux
detection:
    selection_activemq_exploit:
        ProcessName|contains: 'java'
        CommandLine|contains:
            - 'activemq'
            - 'org.apache.activemq'
        ParentProcessName|contains:
            - 'activemq'
            - 'java'
    
    selection_curl_download:
        ProcessName: '/usr/bin/curl'
        CommandLine|contains:
            - 'repo1.maven.org'
            - 'activemq-client-'
            - 'activemq-openwire-legacy-'
            - '-s -L -o'
    
    selection_ssh_modification:
        ProcessName|endswith:
            - '/sed'
            - '/echo'
            - '/tee'
        CommandLine|contains:
            - '/etc/ssh/sshd_config'
            - 'PermitRootLogin yes'
            - 'PasswordAuthentication yes'
    
    selection_suspicious_user:
        ProcessName|contains:
            - 'usermod'
            - 'useradd'
        CommandLine|contains:
            - 'games'
            - '/bin/bash'
            - '/home/games'
    
    selection_dropper_execution:
        ProcessName|contains: 'python'
        CommandLine|contains:
            - 'PyInstaller'
            - '.pyc'
        ProcessName|startswith: '/tmp/'
    
    condition: 
        (selection_activemq_exploit and selection_curl_download) or
        (selection_ssh_modification and selection_suspicious_user) or
        (selection_dropper_execution and selection_curl_download)

falsepositives:
    - Legitimate ActiveMQ maintenance
    - System administration activities
    - Software updates

level: critical