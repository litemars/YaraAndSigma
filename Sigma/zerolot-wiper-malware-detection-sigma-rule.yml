title: ZEROLOT Wiper Malware Detection
id: 7e9f4a2b-8c3d-4e5f-9a1b-2c3d4e5f6a7b
status: experimental
description: Detects ZEROLOT wiper malware activities associated with Sandworm APT group
author: litemars
date: 2025/08/28
references:
    - https://www.eset.com/us/about/newsroom/research/eset-research-apt-report-russian-cyberattacks-in-ukraine-intensify-sandworm-unleashes-new-destructive-wiper/
    - https://www.immersivelabs.com/resources/blog/zerolot-analysis-inside-sandworms-destructive-new-wiper
tags:
    - attack.impact
    - attack.t1485  
    - attack.t1561.002  # Disk Structure Wipe
    - attack.defense_evasion
    - attack.t1497  # Virtualization/Sandbox Evasion
logsource:
    category: process_creation
    product: windows
detection:
    selection_fsutil_zero:
        Image|endswith: '\\fsutil.exe'
        CommandLine|contains:
            - 'setzerodataoffset'
            - 'file setzerodataoffset'
    
    selection_physical_drive_access:
        CommandLine|contains:
            - '\\\\.\\\\PhysicalDrive'
            - 'PhysicalDrive0'
            - 'PhysicalDrive1'
    
    selection_suspicious_process:
        ParentImage|endswith:
            - '\\taskhost.exe'
            - '\\svchost.exe'
            - '\\rundll32.exe'
        Image|endswith:
            - '\\fsutil.exe'
            - '\\diskpart.exe'
            - '\\wmic.exe'
    
    selection_registry_autoruns:
        Image|endswith: '\\reg.exe'
        CommandLine|contains:
            - 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run'
            - 'REG_SZ /d ""'
            - '/v StartupFolder /t REG_SZ /d'
    
    selection_wipe_indicators:
        CommandLine|contains:
            - 'cipher /w:'
            - 'sdelete -p'
            - 'format /fs:NTFS /p:'
            - 'diskpart /s'
    
    condition: 
        (selection_fsutil_zero and selection_physical_drive_access) or
        (selection_suspicious_process and selection_fsutil_zero) or
        (selection_registry_autoruns and selection_wipe_indicators) or
        (2 of selection_*)

falsepositives:
    - Legitimate system administration activities
    - Disk maintenance operations
    - System recovery procedures

level: critical
