title: Suspicious DLL Loading from Alternate Path (MiniJunk)
id: d3f1c2e1-9a5b-4b6f-b2ad-8e7f2c3a1d4f
description: Detects processes loading userenv.dll from non-standard paths indicative of the MiniJunk backdoor
status: experimental
author: litemars
references:
  - https://research.checkpoint.com/2025/nimbus-manticore-deploys-new-malware-targeting-europe/7
logsource:
  product: windows
  service: sysmon
detection:
  selection:
    EventID: 7                      # Sysmon DLL load
    TargetImage|endswith:
      - "\\userenv.dll"
    # Non-standard location: not in System32
    TargetImage|contains:
      - "\Temp\"
      - "\AppData\Local\"
  condition: selection
falsepositives:
  - Legitimate DLLs renamed for testing
  - Non-malicious loaders using userenv.dll in non-standard paths
level: high
