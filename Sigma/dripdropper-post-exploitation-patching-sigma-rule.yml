title: DripDropper Post-Exploitation Patching
id: 5f7a9c2d-6e8b-1f4a-5c7d-9e2f4a6b8c1d
status: experimental
description: Detects DripDropper's unique behavior of patching exploited vulnerabilities
author: litemars
date: 2025/08/28
tags:
    - attack.defense_evasion
logsource:
    category: process_creation
    product: linux
detection:
    selection_maven_download:
        ProcessName|contains:
            - 'curl'
            - 'wget'
        CommandLine|contains:
            - 'repo1.maven.org'
            - 'maven2'
            - 'org/apache/activemq'
    
    selection_jar_replacement:
        ProcessName|contains:
            - 'cp'
            - 'mv'
            - 'rm'
        CommandLine|contains:
            - 'activemq'
            - '.jar'
        TargetFilename|contains:
            - '/opt/activemq'
            - '/apache-activemq'
    
    selection_service_restart:
        ProcessName|contains:
            - 'systemctl'
            - 'service'
        CommandLine|contains:
            - 'restart'
            - 'reload'
            - 'activemq'
    
    timeframe: 30m
    condition: 
        selection_maven_download and
        selection_jar_replacement and
        selection_service_restart

falsepositives:
    - Legitimate ActiveMQ updates
    - System maintenance
    - Security patching activities

level: medium
